/*Молодяков Константин ВИтальевич(702)
Лабораторная работа №4.
Вариант 5.
Задача 1.

Создать процедуру, которая принимает в качестве параметра имя таблицы. Процедура выводит на экран информацию 
обо всех индексах, связанных с указанной таблицей, в виде:     имя_индекса (имя_поля1,…, имя_поляN).*/


create or replace
procedure "Курсоры_и_поля"(table_name in varchar2) is
--Переменные 
  index_name varchar(100);
	column_name varchar(100);
	str_out varchar(2000);	
--Курсоры
	type ref_cur is ref cursor;
	ind ref_cur;
	col ref_cur;

begin
  open ind for 'select index_name from dba_indexes where table_name=:tname' using table_name;
	loop fetch ind into index_name;
    exit when ind%notfound;
    str_out:=index_name||'(';
    
		open col for 'select column_name from dba_ind_columns where table_name=:tname and index_name=:iname' using table_name, index_name;
		loop fetch col into column_name;
		exit when col%notfound;
			str_out:=str_out||column_name||',';
		end loop;
    
    dbms_output.put_line(rtrim(str_out,',')||')');
	end loop;
end;